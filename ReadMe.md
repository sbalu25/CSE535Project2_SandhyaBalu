# SmartHome Gesture Control Application

## Prerequisites
* TensorFlow
* Python 3.6.9
* OpenCV for Python
* Keras

## Project Description
This project contains the following functionalities
1. Generating the penultimate layer of the training videos
    * We use the practice gesture videos generated by Smart Home mobile application in project part 1 and extract the midle frames of all the training vdieos.
    * For each gesture video, you will have one frame extract the hand shape feature by calling the get_instance() method of the HandShapeFeatureExtractor class. (HandShapeFeatureExtractor class uses CNN model that is trained for alphabet gestures)
    * For each gesture, extract the feature vector
    * Feature vectors of all the gestures is the penultimate layer of the training set.

2. Generate the penultimate layer for the test videos.
    * Use the same steps as above for generating the penultimate layer for test videos.

3. Test dataset's gesture recognition.
    * Apply cosine similarity between the gesture video's vector and the training set penultimate layer. The recognition of the gesture is the matching gesture of the training set vector with the smallest cosine difference.
    * Gesture number is saved in Results.csv file.
    * Recognize the gestures in all of the videos from the test dataset and save results to the results.csv file.

Below are the 17 gestures and the output gesture number 

| Gesture Name | Output Number |
| -----------  | ------------- |
| 0 | 0 |
| 1 | 1 |
| 2 | 2 |
| 3 | 3 |
| 4 | 4 |
| 5 | 5 |
| 6 | 6 |
| 7 | 7 |
| 8 | 8 |
| 9 | 9 |
| Decrease Fan Speed | 10 |
| FanOn | 11 |
| FanOff | 12 |
| Increase Fan Speed | 13 |
| LightOff | 14 |
| LightOn | 15 |
| SetThermo | 16 |

## Directory Structure

| File/Folder  | Contents |
| -----------  | -------- |
| traindata | 51 training gesture videos generated using Smart Home mobile application |
| main.py | Implementation of gesture recognition |
| cnn_model.h5 |  CNN model which is trained for alphabet gestures |
| handshape_feature_extractor.py | Implementation of extraction of middle frame from gestrue video |
| test_penultimate.csv | CSV file which has feature vectors of test gesture videos | 
| training_penultimate.csv | CSV file which has feature vectros of train gesture videos |
| ReadMe.md | This file |
| Report.pdf | An explanation on approaching the problem and solution to it |




